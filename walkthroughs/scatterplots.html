<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lesson: Ticket price vs daily riders using scatter plots with trend lines</title>
  <style>
    :root { --bg:#ffffff; --card:#ffffff; --text:#111827; --muted:#6b7280; --accent:#2563eb; --border:#e5e7eb; }

    *{ box-sizing:border-box; }

    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:var(--bg);
      color:var(--text);
      line-height:1.5;
    }

    /* Fully responsive width */
    .wrap{
      width: min(1100px, calc(100vw - 36px));
      margin: 0 auto;
      padding: 28px 0 60px;
    }

    h1{ font-size: 28px; margin: 0 0 6px; }
    p{ margin: 10px 0; color: var(--muted); }

    .card{
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 18px;
      margin: 22px 0;              /* clear vertical separation */
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
    }

    .badge{
      display:inline-block;
      font-size: 12px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(37,99,235,0.08);
      color: var(--accent);
      border: 1px solid rgba(37,99,235,0.18);
    }

    ul{ margin: 8px 0 0 18px; color: var(--muted); }

    code, pre{
      font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    }

    pre{
      margin: 0;
      padding: 14px;
      border-radius: 12px;
      background: #0b1020;
      border: 1px solid rgba(255,255,255,0.10);
      overflow:auto;
      color:#e7eef7;
      max-width:100%;
    }

    .solnHead{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }

    .btn{
      cursor:pointer;
      user-select:none;
      background: rgba(37,99,235,0.08);
      border: 1px solid rgba(37,99,235,0.22);
      color: var(--accent);
      padding: 6px 10px;
      border-radius: 10px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-weight: 650;
    }

    .btn:focus{
      outline: 2px solid rgba(37,99,235,0.35);
      outline-offset: 2px;
    }

    .blurred pre{ filter: blur(7px); transition: filter 180ms ease; }
    .revealed pre{ filter: none; }

    .note{ margin-top: 10px; font-size: 13px; color: var(--muted); }
    .icon{ width: 18px; height: 18px; display:inline-block; }

    .callout{
      border-left: 4px solid rgba(37,99,235,0.45);
      padding-left: 12px;
      margin: 10px 0;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Ticket price vs daily riders with a trend line coloured by mode</h1>
    <p>
      Goal: make a scatter plot that shows routes against cost.
      We plot <code>avg_ticket_price</code> (x) against <code>avg_daily_riders</code> (y),
      and colour points by <code>transport_mode</code>.
      Then we add a simple linear trend line.
    </p>

    <div class="card">
      <h2 style="margin:0 0 6px;font-size:18px;">Key ideas</h2>
      <ul>
        <li>Scatter plots show relationships between two numeric variables.</li>
        <li>Use <code>alpha</code> to handle lots of points.</li>
        <li><code>geom_smooth(method = "lm")</code> adds a linear trend line.</li>
      </ul>
      <div class="callout">
        Remember !: Trend lines are just a summary. They do not prove causation.
      </div>
    </div>

    <div class="card">
      <h2 style="margin:0 0 6px;font-size:18px;">Try it</h2>
      <pre><code>library(tidyverse)
library(scales)

usage <- read_csv("data_clean/transport_usage_clean.csv", show_col_types = FALSE)

# Plot avg_ticket_price vs avg_daily_riders
# Colour by transport_mode
# Add a linear trend line</code></pre>
    </div>

    <div class="card blurred" id="solution">
      <div class="solnHead">
        <h2 style="margin:0;font-size:18px;">Solution</h2>
        <button class="btn" type="button" onclick="toggleSolution('solution')">
          <svg class="icon" viewBox="0 0 24 24" fill="none">
            <path d="M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7S2 12 2 12Z" stroke="currentColor" stroke-width="2"/>
            <path d="M12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" stroke="currentColor" stroke-width="2"/>
          </svg>
          Reveal
        </button>
      </div>

      <pre><code>library(tidyverse)
library(scales)

usage <- read_csv("data_clean/transport_usage_clean.csv", show_col_types = FALSE) %>%
  mutate(transport_mode = as.factor(transport_mode))

ggplot(usage, aes(x = avg_ticket_price, y = avg_daily_riders, colour = transport_mode)) +
  geom_point(alpha = 0.35) +
  geom_smooth(method = "lm", se = FALSE) +
  scale_x_continuous(labels = dollar_format(prefix = "Â£")) +
  scale_y_continuous(labels = comma) +
  labs(
    title = "Ticket price vs daily riders by mode",
    x = "Average ticket price",
    y = "Average daily riders"
  ) +
  theme_minimal(base_size = 12) +
  theme(legend.position = "bottom")</code></pre>

      <div class="note">
        Should we facet by city to see if relationships differ across places?.
      </div>
    </div>

    <div class="card">
      <h2 style="margin:0 0 6px;font-size:18px;">Checks and questions</h2>
      <ul>
        <li>Does the relationship look similar for every mode?</li>
        <li>Are there clusters that suggest different kinds of routes?</li>
        <li>What might cause a higher price but also higher demand and how can we assess this relationship?</li>
      </ul>
    </div>
  </div>

  <script>
    function toggleSolution(id){
      const el = document.getElementById(id);
      const btn = el.querySelector("button");
      const revealed = el.classList.toggle("revealed");
      el.classList.toggle("blurred", !revealed);
      btn.lastChild.textContent = revealed ? " Hide" : " Reveal";
    }
  </script>
</body>
</html>